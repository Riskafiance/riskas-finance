{% extends 'accounting/base.html' %}

{% block content %}
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1>Fixed Assets</h1>
        <a href="{% url 'add_asset' %}" class="btn btn-primary">
            <i class="bi bi-plus-lg"></i> Add New Asset
        </a>
    </div>

    <div class="alert alert-light border shadow-sm mb-4">
        <h5 class="alert-heading text-primary"><i class="bi bi-building-gear"></i> Asset Lifecycle Management</h5>
        <hr>
        <div class="row">
            <div class="col-md-8">
                <p class="mb-0">
                    **Fixed Assets** are long-term items (like computers, vehicles, or furniture) that your business owns and uses to generate income. 
                    Unlike regular expenses, these items are "Capitalized" and their cost is spread out over time through **Depreciation**.
                </p>
                <p class="small text-muted mt-2 mb-0">
                    <i class="bi bi-graph-down-arrow text-danger"></i> <strong>Current Value:</strong> 
                    The value shown below is the estimated **Net Book Value** (Original Purchase Cost minus Accumulated Depreciation).
                </p>
            </div>
            <div class="col-md-4 border-start">
                <div class="d-flex align-items-center">
                    <i class="bi bi-hourglass-split fs-1 text-muted me-3"></i>
                    <div>
                        <small class="fw-bold text-uppercase text-muted">Asset Lifecycle</small><br>
                        <small>Acquire &rarr; Depreciate &rarr; Dispose</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card bg-dark text-white p-3 mb-4">
        <form method="GET" class="d-flex">
            <input type="text" name="search" class="form-control bg-dark text-white border-secondary me-2" placeholder="Search Name, Category, or Asset #..." value="{{ search_query }}">
            <button type="submit" class="btn btn-primary"><i class="bi bi-search"></i> Search</button>
        </form>
    </div>

    <div class="card shadow-sm border-0">
        <div class="card-body p-0">
            <table class="table table-striped table-hover mb-0">
                <thead class="table-dark">
                    <tr>
                        <th>Asset Number</th>
                        <th>Name</th>
                        <th>Category</th>
                        <th>Location</th>
                        <th>Acquisition Date</th>
                        <th>Purchase Cost</th>
                        <th>Current Value (Est)</th>
                        <th>Status</th>
                        <th class="text-end">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for asset in assets %}
                    <tr>
                        <td>
                            <a href="{% url 'asset_detail' asset.id %}" class="text-decoration-none fw-bold text-primary">
                                {{ asset.asset_number }}
                            </a>
                        </td>
                        <td>{{ asset.name }}</td>
                        <td><span class="badge bg-secondary">{{ asset.category }}</span></td>
                        <td><small class="text-muted">{{ asset.location|default:"--" }}</small></td>
                        <td>{{ asset.acquisition_date }}</td>
                        <td>${{ asset.purchase_cost|floatformat:2 }}</td>
                        <td class="fw-bold text-success">${{ asset.current_value|floatformat:2 }}</td>
                        <td>
                            <span class="badge {% if asset.status == 'Active' %}bg-success{% else %}bg-danger{% endif %}">
                                {{ asset.status }}
                            </span>
                        </td>
                        <td class="text-end">
                            <div class="btn-group" role="group">
                                <a href="{% url 'asset_detail' asset.id %}" class="btn btn-sm btn-info" title="View Details">
                                    <i class="bi bi-eye"></i>
                                </a>
                                
                                <a href="{% url 'edit_asset' asset.id %}" class="btn btn-sm btn-primary" title="Edit Asset">
                                    <i class="bi bi-pencil"></i>
                                </a>
                                
                                {% if asset.status == 'Active' %}
                                    <a href="{% url 'dispose_asset' asset.id %}" class="btn btn-sm btn-danger" title="Dispose/Sell Asset">
                                        <i class="bi bi-x-circle"></i>
                                    </a>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="9" class="text-center py-5 text-muted">
                            <i class="bi bi-box-seam fs-1 d-block mb-2"></i>
                            No fixed assets found.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}